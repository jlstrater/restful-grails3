!!! 5
//if IE 7
  html(lang="en", class="no-js ie", data-ng-app="main", id="ng-app")
//if IE 8
  html(lang="en", class="no-js ie", data-ng-app="main", id="ng-app")
//if IE 9
  html(lang="en", class="no-js ie9", data-ng-app="main", id="ng-app")
//if [(gt IE 9)|!(IE)] <!
html(class="no-js", ng-app="main")
  // <![endif]
  head
    meta(charset="utf-8")
    title Restful Web Services in Grails 3
    meta(name="viewport", content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no")
    meta(name="apple-mobile-web-app-capable", content="yes")
    meta(name="apple-mobile-web-app-status-bar-style", content="black-translucent")
    meta(name="description", content="Reveal JS Template")
    link(href="./assets/css/style.css", rel="stylesheet", type="text/css")

  body
    .reveal
      .opi-logo
      .slides
        section(data-state="index-slide")
          h2(style="color:white; margin-top:42%") Restful Web Services in Grails 3
          small(style="color:white;") by Jenn Strater <a href="http://twitter.com/jennstrater" target="_blank"><img style="border:none;margin-top:0px;box-shadow:none;" src="./assets/img/CompanyAndProductLogos/twitter.png"/>@jennstrater</a>
        section(data-state="github-slide", class="github-section")
          h1 <i class="fa fa-icon fa-github"></i>
          p
            a(href="http://jlstrater.github.io/Restful-Grails3") http://jlstrater.github.io/Restful-Grails3
          p
            a(href="http://github.com/jlstrater/restful-grails-3",target="_blank") Slides(source)
        section
          h2 About Me
          p Professional
          ul
            li Senior Consultant - <a href="http://objectpartners.com" target="_blank">Object Partners</a>
            li Full Stack Engineer
            li Co-Founder - <a href="http://www.gr8ladies.org" target="_blank">Gr8Ladies</a>
        section
          h2 About Me
          p Minneapolis, MN
          p <img style="border:none;margin-top:-25px;" src="./assets/img/minnesota.png"/>
          ul.ul-no-style Connect on Social Media
            li <a href="https://twitter.com/jennstrater" target="_blank">Twitter</a> @jennstrater
            li <a href="https://linkedin.com/in/jennstrater" target="_blank">LinkedIn</a> https://linkedin.com/in/jennstrater
            li <a href="https://github.com/jlstrater" target="_blank">Github</a> https://github.com/jlstrater

        section
          h2 Agenda
          ul
            li Remedial REST
            li  Ways To Improve A RESTful API
            ul
              li with Grails Examples
            li Related Grails Plugins

        section
          h2 What this talk will NOT cover
          ul
            li Scalability of Grails APIs
            li Security
            li Ingesting RESTful APIs

        section
          h2 Remedial REST

        section
          h2 Terminology
          ul
            li Application Programming Interface (API)
            li Web Service
            li Representational State Transfer (REST)

        section
          h2 Definition
          blockquote.
            <b>RE</b>presentational <b>S</b>tate <b>T</b>ransfer (REST) is an architectural style that
            describes how distributed data objects, or resources, can be defined and addressed, stressing the easy exchange
            of information and scalability.<ital>(Fischer 2013.)</ital>
          aside.notes
            NOT a standard or specification

        section
          h2 History
          p Described in Roy Fielding's 2000 PhD dissertation
          small Fielding, Roy. <ital><a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">Architectural Styles and the Design of Network-based Software Architectures<ital></a>. 2000.
        section
          h2 Goals
          ul
            li To create a uniform interface between components
            li Decouple implementations from the underlying services

        section
          h1 Characteristics
        section
          h2 Uniform Interface
          ul
            li Individual Resources are identified using URIs
            li Resources are abstracted from the data source and can be manipulated before being sent to a client
            li <b>Hypermedia As The Engine Of Application State (HATEOAS)</b>

        section
          h2 Stateless
          ul Self-contained and independent requests
            li Improves scalability
            li Allows for parallel processing of requests
            li Lets resources be viewed in isolation

        section
          h2 Client-Server
          ul Decoupled clients and servers
            li Increases portability
            li Easier to scale

        section
          h2 Layered System
          ul Endpoints can be the terminus or an intermediary service
            li Allows for load balancing and intermediate security enforcers

        section
          h2 Why choose REST?
          ul
            li Easy to implement
            li Usable across many different platforms and languages

        section
          h2 Why REST and Grails?
          p.fragment Many helpful defaults
          ul.fragment Other advantages of Grails
            li Ease of development
            li Shorter development time

        section
          h2 Questions about REST?

        section
          h2 Ways To Improve A RESTful API
          h3 (with Grails)

        section
          h2 Scope
          p De-coupled server and client
          p NO GSPs!
        section
          h2 New in Grails 3
          ul
            li Based on Spring Boot
            li Switched to Gradle for build system
            li Major structural changes
            ul
              li Configuration
              li Scripts

        section
          h2 Getting Started
          p Resource Transformation
          pre.
            <code class="java">import grails.rest.Resource

            @Resource(uri='/gr8ladies')
            class Gr8Lady {
              String first
              String last
            }</code>
        section
          h2 Getting Started
          p URL mappings
          pre.
            <code class="java">URLmappings.groovy

            "/gr8ladies"(resources:"gr8lady")</code>
          p Or
          pre.
            <code class="java">"/gr8ladies"(resources:"gr8lady") {
              "/chapter"(controller:"chapter", method:"GET")
            }</code>
          small --> /gr8ladies/{id}/chapter
        section
          h2 HTTP Status Codes
          ul
            li 200 is ok ... but not for everything
        section
          h2 HTTP Status Codes
          p Learn the correct status codes for different errors
          table(align="center")
            tr
              th Code
              th Description
            tr
              th 2XX
              th Successful
            tr
              td 200
              td OK
            tr
              th 4XX
              th Client Error
            tr
              td 400
              td Bad Request
            tr
              td 403
              td Forbidden
            tr
              td 404
              td Not Found
            tr
              th 5XX
              th Server Errors
            tr
              td 500
              td Internal Server Error
            tr
              td 502
              td Bad Gateway

          small
            span an exerpt from
            a(href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html", target="_blank") http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html
        section
          h2 HTTP Status Codes in Grails
          p Many of the cases are handled by Grails or the server(i.e. 5XXs)
          pre.
            <code class="java">if(someCondition) {
              render status: 4XX
            }</code>
        section
          h2 HTTP verbs
          ul
            li GET to retrieve a resource
            li POST to create a new resource
            li PUT to update an existing resource
            li DELETE to remove an existing resource
        section
          h2 HTTP verbs in Grails
          h3 Resource Annotation
          p.fragment Handled by Default! :)
        section
          h2 HTTP verbs in Grails
          p On each Controller
          pre.
            <code class="java">class Gr8LadyController {
              static allowedMethods = [list: "GET", save: "POST", update: "PUT"]
            }</code>
        section
          h2 HTTP verbs in Grails
          p URL Mappings
          pre.
            <code class="java">"/gr8ladies"(resource: "gr8lady", method: "GET")</code>
        section
          h2 Endpoints
          h3 List
          p <code class="http">http://example.com/resource</code>
          h3 Show
          p <code class="http">http://example.com/resource/{id}</code>
        section
          h2 Endpoints
          ul
            li <code class="http">http://example.com/resource/{id}</code>
            li.fragment NOT <code class="http">http://example.com/resource?id=abc123</code>
            li.fragment NOT <code class="http">http://example.com/resource/{id}/?action=delete</code>
            li.fragment NOT <code class="http">http://example.com/resource/add</code>
        section
          h2 Consistent Style
          h3 casing
          p <code class="http">/resources</code>
          p NOT
          p <code class="http">/ReSoUrCeS</code>
        section
          h2 Consistent URI style
          p Try Either:
          p <code class="http">/multiWordResources</code>
          p Or:
          p <code class="http">/multi-word-resources</code>
          p And stick to it. Don't Mix and Match!
        section
          h2 Consistent Style
          h3 Resource Names
          p plural nouns preferred
          <code>http://example.com/users</code>
          p vs
          <code>http://example.com/user</code>
        section
          h2 Search
          ul <code>http://example.com/resource?fieldName=value</code>
            li Lookup based on values

        section
          h2 Multiple Media Types (JSON, XML)
          ul
            li XML and JSON are most common
        section
          h2 Multiple Media Types (JSON, XML) in Grails
          ul
            li XML by default
            li
              p By Parameter
              <code>http://example.com/resource.json</code>
        section
          h2 Multiple Media Types (JSON, XML) in Grails
          p Available formats
          pre.
            <code class="java">grails:
              mime:
                types:
                ...
                json: ['application/json', 'text/json'],
                ...
                xml: ['text/xml', 'application/xml']</code>
        section
          h2 Multiple Media Types (JSON, XML) in Grails
          p By Resource
          pre.
            <code class="java">import grails.rest.Resource

            @Resource(uri='/gr8ladies', formats=['json'])
            class Gr8Lady {
              ...
            }</code>
          p Requesting another type returns a 406 (Not Acceptable)
        section
          h2 Multiple Media Types (JSON, XML) in Grails
          p By RestfulController
          pre.
            <code>class Gr8LadyController extends RestfulController {
              static responseFormats = ['json', 'xml']
            }</code>
          p Remember to add any response formats for versioned mime types
        section
          h2 Custom Response Formats
          ul
            li Filter from default responses
            li Provide different responses per version
            li Provide response formats based on security
        section
          h2 Custom Response Formats in Grails
          p Object Marshallers
          p <code>grails-app/init/Bootstrap.groovy</code>
          pre.
            <code class="java">import grails.converters.JSON

            class Bootstrap {
              def init = { servletContext ->
                JSON.registerObjectMarshaller(Gr8Lady) {
                  def returnArray = [:]
                  returnArray['firstName'] = it.first
                  returnArray['lastName'] = it.last
                  returnArray['chapter'] = it.chapter?.name
                  return returnArray
                }
              }
            }</code>
          p Usage
          pre.
            <code>render gr8lady as JSON</code>
        section
          h2 Custom Response Formats in Grails
          p Object Marshallers
          p <code>grails-app/conf/spring/resources.groovy</code>
          pre.
            <code class="java">import grails.converters.JSON
            import org.gr8ladies.ChapterMarshaller

            beans = {
                JSON.registerObjectMarshaller(new ChapterMarshaller())
            }</code>
        section
          h2 Custom Response Formats in Grails
          p Object Marshallers
          pre.
            <code>class Gr8LadyMarshaller implements ObjectMarshaller&#60JSON&#62{
                public boolean supports(Object object) {
                  return object instanceof Gr8Lady
                }

                public void marshalObject(Object object, XML converter) {
                  Gr8Lady gr8lady  = (Gr8Lady)object
                  converter.chars gr8lady.displayName
                }
            }</code>
        section
          h2 Hypermedia As The Engine Of Application State (HATEOAS)<sup>*</sup>
          p link to the resource and navigation
          pre.
            <code class="javascript">{
              "_links": {
                "self": { "href": "/gr8ladies" },
                "next": [
                  { "href": "/gr8ladies?page=2" }
                ]
              }
            }</code>
        section
          h2 HATEOAS in Grails
          ul
            li JSON
            li Hypertext Application Language (HAL)
            p <code>grails-app/conf/spring/resources.groovy</code>
            pre.
              <code>import grails.rest.render.hal.*
              beans = {
                  halGr8LadyRenderer(HalJsonRenderer, org.gr8ladies.Gr8Lady)
              }</code>
        section
          h2 HATEOAS in Grails
          p Usage: Content Negotiation
          p <code>curl -i -H "Accept: application/hal+json" http://localhost:8080/gr8ladies/1</code>
          pre.
            <code>HTTP/1.1 200 OK
            Server: Apache-Coyote/1.1
            Content-Type: application/hal+json;charset=ISO-8859-1

            {
              "_links": {
                "self": {
                  "href": "http://localhost:8080/gr8ladies/1",
                  "hreflang": "en",
                  "type": "application/hal+json"
                }
              },
              "name": ""Grace Hopper""
            }</code>
        section
          h2 Pagination<sup>*</sup>
          p Parameters
          p <code>http://example.com/resource?offset=0&max=10</code>
          pre.
            <code>def list() {
              List gr8ladies = Gr8Lady.list(max: params.max, offset: params.offset)
              respond [results: gr8ladies, max: params.max, offset: params.offset]
            }</code>
        section
          h2 Versioning<sup>*</sup>
          ul
            li <b>URI</b> <code class="http">http://example.com/v1/resource/{id}</code>
            li <b>Custom Header</b>
            li
              pre.
                <code class="http">GET https&#58;&#47;&#47;example.com/resource
                version&#58; 2.0</code>
            li <b>Content Type</b>
            li
              pre.
                <code class="http">GET https&#58;&#47;&#47;example.com/resource
                Accept&#58; application/vnd.example.v2+json</code>
          aside.notes.
            If you really can't use hypermedia, please at least version your API. There are several ways to do this, each
            with their own pros and cons.  The easiest to implement is to add /v1/ to the URI.  However, this breaks theory
            since the URI is no longer just about the resource data.  Be careful if you choose this route as it can cause
            confusion when some resources are at various version numbers (ie http://example.com/v2/parentResource/v1/childResource).
            Another option is to add the version number to the headers. This maintains the purity of the URI, but makes it
            harder for consumers of the API. You can't just have a one button/link for the GET request.  The last option
            is to specify the version number in the accept header.
        section
          h2 Versioning in Grails
          ul
            ul <b>URI</b>
              li <code class="http">@Resource(uri='/gr8ladies/v1')</code>
              li <code class="http">@Resource(uri='/gr8ladies/v2')</code>
            ul <b>Accept Header</b>
              li <code class="http">"/gr8ladies"(version:'1.0', resources:"gr8lady", namespace: 'v1')</code>
              li <code class="http">"/gr8ladies"(version:'2.0', resources:"gr8lady", namespace: 'v2')</code>

        section
          h2 Read-only Mode
          ul
            li for public APIs (or security)

        section
          h2 Read-only Mode in Grails
          pre.
            <code>@Resource(uri="/gr8ladies", readOnly=true)
            class Gr8LadyController {
              String first
              ...
            }</code>
        section
          h2 Related Plugins for other Grails versions

        section
          h2 Spring Security REST Plugin
          p Token based Authentication based on Spring-Security
          p <img class="inline-thumb" src="./assets/img/active-icon.png"/>
          p Last Updated May 2015
          p <a href="https://github.com/alvarosanchez/grails-spring-security-rest">Source & Documentation</a>

        section
          h2 Restful API Plugin
          p Last Updated November 2014
          p <a href="https://github.com/restfulapi/restful-api">Source & Documentation</a>

        section
          h2 Rest Renderer
          p Last Updated February 2014
          p <a href="https://github.com/danveloper/grails-rest-renderers">Source & Documentation</a>

        section
          h2 Conclusions
          ul
            li REST is an architecture style, not a standard
            li There are many ways to implement REST
            li Grails makes REST easy with <code>@Resource</code>!
            li Don't reinvent the wheel, use standard practices.

        section
          h3 Questions?
          <img src='./assets/img/halofunnyface.jpg' style="border:none;margin:0px;">
          <img src='./assets/img/pumpkinloaf.jpg' style="border:none;">
          <img src='./assets/img/upsidedownpumpkin.jpg' style="border:none;">
          <img src='./assets/img/halopanic.jpg' style="border:none;margin:0px;">

        section
          h2 References
          ul.ul-no-style
            li Kay, Russell. <a href="http://www.computerworld.com/article/2552929/networking/representational-state-transfer--rest-.html">"Representational State Transfer (REST)"</a>. <ital>Computerworld</ital>. 6 Aug 2007. Web
            li Fischer, Ludovico. <a href="http://code.tutsplus.com/tutorials/a-beginners-guide-to-http-and-rest--net-16340">"A Beginnerâ€™s Guide to HTTP and REST"</a>. <ital>Tuts+</ital>. 9 Jan 2013. Web
            li Fielding, Roy. <ital><a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">Architectural Styles and the Design of Network-based Software Architectures<ital></a>. 2000.

    script(src="./assets/js/app.js")

    // If the query includes 'print-pdf', use the PDF print sheet
    script(type='text/javascript').
      if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './assets/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      } else if ( window.location.search.match( /print-paper/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './assets/css/print/paper.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      }

